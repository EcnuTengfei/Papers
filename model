(declare-sort Message)
(declare-const OneA Message)
(declare-const OneB Message)
(declare-const TwoA Message)
(declare-const TwoB Message)
(declare-const msgs Message)
(declare-const maxVBal Int)
(declare-const maxBal Int)
(declare-const maxVal Int)
(declare-sort Acceptor)
(declare-const a Acceptor)
(declare-const b Int)
(declare-const type Message)
(declare-const bal Int)
(declare-fun prepare (Message Int) Bool)
(assert (= type OneA))
(assert (= bal b))
(assert (= (prepare type b) true))
(check-sat)

(declare-const acc Acceptor)
(assert (= type OneA))
(assert (> bal maxBal))
(declare-fun promise (Message Int Int Int Acceptor) Bool)
(assert (= (promise type bal maxVBal maxVal acc) true))
(check-sat)


declare-const v Int)
(declare-const c Int)
(declare-fun f (Acceptor Message) Message)
(declare-fun g (Acceptor Int) Int)
(assert (= type TwoA))
(assert (forall ((a Acceptor)) 
			(and (= (f a type) TwoA)
				(= (g a bal) b)
)))
(assert (exists ((v Int))
	 	(exists ((m Message)) 
	 		(and (= (f a type) OneB)
				(= (g a bal) b)
			))
))
(assert (forall ((a Acceptor)) 
		(exists ((m Message)) 
				(= acc a)
)))
(assert (or (exists ((c Int)) 
			(and (> c 0) 
				(< c (- b 1))
		)) 
		(forall ((m Message))
			 (<= maxVBal c)
		)
		(exists ((m Message))
             		(and (= maxVBal c) 
             	      		(= maxVBal v)
		))
))
(declare-fun accept (Message Int Int) Bool)
(assert (= (accept TwoA b v) true))
(check-sat)


(declare-const val Int)
(declare-fun learn (Message Int Int 
			Acceptor) Bool)
(assert (exists ((m Message)) 
		(and (= type TwoA)
			(>= bal maxBal)
		)
))
(assert (= (learn TwoB bal val a) true))
(check-sat)
(get-model)
